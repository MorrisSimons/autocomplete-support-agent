{"map":{"version":3,"sources":["static/js/main.35abb179.chunk.js"],"names":["this","push","14","module","__webpack_exports__","__webpack_require__","r","react","react_default","n","react_dom","react_dom_default","objectSpread2","objectWithoutProperties","dist","_excluded","_excluded2","streamlit_copilot_Copilot","[object Object]","super","arguments","userTextarea","suggestionTextarea","state","text","suggestion","isFocused","textAreaIsFocused","requestsThisMinute","currentMinute","Math","floor","Date","now","totalRequests","successfulRequests","failedRequests","inputCost","outputCost","totalCost","debounceTimer","render","theme","props","a","createElement","height_int","args","font_fam","font","f_height","f_focused","primaryColor","f_not_focused","secondaryBackgroundColor","style","fontSize","color","textColor","marginBottom","padding","backgroundColor","borderRadius","border","display","justifyContent","alignItems","toFixed","onClick","resetCounters","cursor","title","tabIndex","height","width","overflowY","overflowX","position","onFocus","_onFocus","onBlur","_onBlur","marginLeft","fontFamily","marginTop","whiteSpace","outline","base","value","readOnly","ref","textarea","onChange","onKeyDown","_onTextAreaBlur","onScroll","forceUpdate","event","target","setState","window","clearTimeout","timer","setTimeout","trim","api_upl","callApi","then","key","preventDefault","prevState","syntheticEvent","setComponentValue","abortController","AbortController","executeToolCalls","async","results","toolCall","toolCalls","_toolCall$function","_toolCall$function2","functionName","function","name","JSON","parse","console","log","concat","mockResult","getMockToolResult","toolName","query","toString","String","queryLower","toLowerCase","includes","makeFollowUpCall","apiUrl","userInput","toolResults","followUpPrompt","join","_this$props$args","prompt_template","api_key","questionText","question_title","model_kwargs","Object","isChatApi","replace","payload","validParams","model","max_tokens","temperature","top_p","stop","messages","role","content","stream","prompt","echo","headers","Content-Type","response","fetch","method","body","stringify","signal","ok","Error","status","responseJson","json","fullResponse","choices","message","error","extractedAnswer","answerTagIndex","indexOf","substring","endTagIndex","abort","Promise","resolve","_this$props$args2","api_url","tools","type","description","parameters","properties","required","tool_choice","_responseJson$usage","_responseJson$usage2","errorText","inputTokens","usage","prompt_tokens","outputTokens","completion_tokens","inputPrice","outputPrice","estimatedInputTokens","ceil","length","newInputCost","newOutputCost","tool_calls","scrollTop","streamlit_copilot","StrictMode","document","getElementById","7","exports"],"mappings":"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"},"code":"(this.webpackJsonpstreamlit_copilot=this.webpackJsonpstreamlit_copilot||[]).push([[0],{14:function(t,e,s){\"use strict\";s.r(e);var o=s(1),r=s.n(o),n=s(5),a=s.n(n),i=s(0),l=s(2),c=s(3);const u=[\"prompt_template\",\"api_key\",\"height\",\"fontFamily\",\"border\",\"text\",\"question_title\"],p=[\"prompt_template\",\"api_url\",\"api_key\",\"height\",\"fontFamily\",\"border\",\"text\",\"question_title\"];class h extends c.b{constructor(){super(...arguments),this.userTextarea=null,this.suggestionTextarea=null,this.state={text:\"\",suggestion:\"\",isFocused:!1,textAreaIsFocused:!1,requestsThisMinute:0,currentMinute:Math.floor(Date.now()/6e4),totalRequests:0,successfulRequests:0,failedRequests:0,inputCost:0,outputCost:0,totalCost:0,debounceTimer:null},this.render=()=>{const{theme:t}=this.props;if(!t)return r.a.createElement(\"div\",null,\"Theme is undefined, please check streamlit version.\");const e=this.props.args.height,s=t.font,o=e+\"px\",n=\"1px solid \"+t.primaryColor,a=\"1px solid \"+t.secondaryBackgroundColor;return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{style:{fontSize:\"1em\",color:t.textColor,marginBottom:\"0.5em\",padding:\"0.5em\",backgroundColor:t.backgroundColor,borderRadius:\"0.3em\",border:\"1px solid \"+t.secondaryBackgroundColor,display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"}},r.a.createElement(\"div\",null,r.a.createElement(\"strong\",null,\"API Stats:\"),\" Total: \",this.state.totalRequests,\" | \\u2705 Success: \",this.state.successfulRequests,\" | \\u274c Failed: \",this.state.failedRequests,\" |\",\"Requests this per minute / limit: \",this.state.requestsThisMinute,\" / \",this.props.args.rpm_limit,r.a.createElement(\"br\",null),r.a.createElement(\"strong\",null,\"Cost:\"),\" Input: $\",this.state.inputCost.toFixed(6),\" | Output: $\",this.state.outputCost.toFixed(6),\" | Total: $\",this.state.totalCost.toFixed(6)),r.a.createElement(\"button\",{onClick:this.resetCounters,style:{fontSize:\"0.7em\",padding:\"0.2em 0.5em\",backgroundColor:t.primaryColor,color:\"white\",border:\"none\",borderRadius:\"0.3em\",cursor:\"pointer\"},title:\"Reset counters\"},\"\\ud83d\\udd04 Reset\")),r.a.createElement(\"div\",{tabIndex:0,style:{height:o,width:\"auto\",border:this.state.isFocused?n:a,borderRadius:\"0.5em\",overflowY:\"scroll\",overflowX:\"hidden\",position:\"relative\",backgroundColor:t.secondaryBackgroundColor},onFocus:this._onFocus,onBlur:this._onBlur},r.a.createElement(\"textarea\",{style:{marginLeft:\"0.5em\",fontFamily:s,marginTop:\"0.2em\",whiteSpace:\"pre-wrap\",width:\"calc(100% - 1.2em)\",height:\"100%\",border:\"none\",outline:\"none\",position:\"absolute\",backgroundColor:\"transparent\",color:\"light\"===t.base?\"rgba(41,51,62,0.5)\":\"rgba(255,255,255,0.5)\",padding:\"0\"},value:this.state.suggestion,readOnly:!0,ref:t=>{this.suggestionTextarea=t}}),r.a.createElement(\"textarea\",{style:{marginLeft:\"0.5em\",fontFamily:s,marginTop:\"0.2em\",whiteSpace:\"pre-wrap\",width:\"calc(100% - 1.2em)\",height:\"100%\",border:\"none\",outline:\"none\",position:\"absolute\",backgroundColor:\"transparent\",color:t.textColor,padding:\"0\"},value:this.state.text,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this._onTextAreaBlur,onScroll:this.onScroll,ref:t=>{this.userTextarea=t}})))},this.onScroll=()=>{this.forceUpdate()},this.onChange=t=>{const e=t.target.value;this.setState({text:e,suggestion:\"\"}),null!==this.state.debounceTimer&&window.clearTimeout(this.state.debounceTimer);const s=window.setTimeout(()=>{if(\"\"!==e.trim()){const t=this.props.args.api_url;this.callApi(e,t).then(t=>{\"\"!==this.state.text.trim()&&this.setState({suggestion:this.state.text+t})})}},500);this.setState({debounceTimer:s})},this.onKeyDown=t=>{\"Tab\"===t.key&&(t.preventDefault(),this.setState(t=>({text:t.suggestion,suggestion:\"\"}),()=>{const t={target:{value:this.state.text}};this.onChange(t)}))},this._onTextAreaBlur=()=>{this.setState({textAreaIsFocused:!1},()=>{c.a.setComponentValue(this.state.text),this.setState({suggestion:\"\"})})},this._onFocus=()=>{this.setState({isFocused:!0})},this._onBlur=()=>{this.setState({isFocused:!1})},this.resetCounters=()=>{this.setState({totalRequests:0,successfulRequests:0,failedRequests:0,requestsThisMinute:0,inputCost:0,outputCost:0,totalCost:0})},this.abortController=new AbortController,this.executeToolCalls=async t=>{const e=[];for(const r of t){var s,o;const t=null===(s=r.function)||void 0===s?void 0:s.name,n=JSON.parse((null===(o=r.function)||void 0===o?void 0:o.arguments)||\"{}\");if(console.log(\"Executing tool: \".concat(t,\" with args:\"),n),\"search_knowledge_base\"===t){const s=this.getMockToolResult(t,n);e.push(s)}else e.push(\"Unknown tool: \".concat(t))}return e},this.getMockToolResult=(t,e)=>{if(\"search_knowledge_base\"===t){let t=\"\";t=\"string\"===typeof e.query?e.query:e.query&&\"object\"===typeof e.query?e.query.toString()||\"\":String(e.query||\"\");const s=t.toLowerCase();return console.log('Processing query: \"'.concat(t,'\" (lowercase: \"').concat(s,'\")')),s.includes(\"avgifter\")||s.includes(\"fees\")||s.includes(\"kostnad\")?\"Lysa charges 0.4% annually for investment accounts\":s.includes(\"sparkonto\")||s.includes(\"interest\")||s.includes(\"r\\xe4nta\")?\"Sparkonto Auto offers 3.5% interest rate\":s.includes(\"pension\")?\"You can transfer your pension to Lysa with no fees\":s.includes(\"isk\")||s.includes(\"investment\")?\"ISK accounts have 0.4% annual fee and tax-efficient structure\":s.includes(\"contact\")||s.includes(\"support\")||s.includes(\"help\")?\"You can contact Lysa support via email at support@lysa.se or call +46 8 123 45 67\":'Searching for: \"'.concat(t,'\". Found general information about Lysa services.')}return\"Mock result for \".concat(t)},this.makeFollowUpCall=async(t,e,s)=>{const o=\"Based on search results: \".concat(s.join(\"\\n\"),'\\n\\nComplete: \"').concat(e,'\"'),r=this.props.args,{prompt_template:n,api_key:a,height:c,fontFamily:p,border:h,text:d,question_title:m}=r,g=Object(l.a)(r,u),f=(n.replace(\"{text}\",d||\"\").replace(\"{question_title}\",m||\"\"),\"chat\"===this.props.args.api_format||t.includes(\"/chat/completions\"));let b;if(f){const t={};g.model&&(t.model=g.model),g.max_tokens&&(t.max_tokens=g.max_tokens),g.temperature&&(t.temperature=g.temperature),g.top_p&&(t.top_p=g.top_p),g.stop&&(t.stop=g.stop),b=Object(i.a)(Object(i.a)({messages:[{role:\"user\",content:o}]},t),{},{stream:!1})}else b=Object(i.a)(Object(i.a)({prompt:o},g),{},{echo:!1});const x={\"Content-Type\":\"application/json\"};a&&(x.Authorization=\"Bearer \".concat(a));try{const e=await fetch(t,{method:\"POST\",headers:x,body:JSON.stringify(b),signal:this.abortController.signal});if(!e.ok)throw new Error(\"HTTP error! status: \".concat(e.status));const s=await e.json();let o=\"\";if(f&&s.choices&&s.choices[0]&&s.choices[0].message)o=s.choices[0].message.content;else{if(!(s.choices&&s.choices[0]&&s.choices[0].text))return console.error(\"Unexpected response format:\",s),\"\";o=s.choices[0].text}let r=\"\";const n=o.indexOf(\"<answer>\");if(-1!==n){r=o.substring(n+8);const t=r.indexOf(\"</answer>\");-1!==t&&(r=r.substring(0,t))}else r=o;return r}catch(y){return console.error(\"Follow-up call error:\",y),\"\"}},this.callApi=async(t,e)=>{if(this.abortController.abort(),this.abortController=new AbortController,\"\"===t.trim())return\"\";const s=Math.floor(Date.now()/6e4);if(s>this.state.currentMinute)this.setState({currentMinute:s,requestsThisMinute:0});else if(this.state.requestsThisMinute>this.props.args.rpm_limit)return new Promise(s=>{setTimeout(()=>{s(this.callApi(t,e))},1e3)});const o=this.props.args,{prompt_template:r,api_url:n,api_key:a,height:c,fontFamily:u,border:h,text:d,question_title:m}=o,g=Object(l.a)(o,p),f=r.replace(\"{text}\",d||\"\").replace(\"{question_title}\",m||\"\"),b=\"chat\"===this.props.args.api_format||e.includes(\"/chat/completions\"),x=[{type:\"function\",function:{name:\"search_knowledge_base\",description:\"Search the Lysa knowledge base for customer support information\",parameters:{type:\"object\",properties:{query:{type:\"string\",description:\"Search query to find relevant information\"}},required:[\"query\"]}}}];let y;if(b){const t={};g.model&&(t.model=g.model),g.max_tokens&&(t.max_tokens=g.max_tokens),g.temperature&&(t.temperature=g.temperature),g.top_p&&(t.top_p=g.top_p),g.stop&&(t.stop=g.stop),y=Object(i.a)(Object(i.a)({messages:[{role:\"user\",content:f}]},t),{},{tools:x,tool_choice:\"auto\",stream:!1})}else y=Object(i.a)(Object(i.a)({prompt:f},g),{},{echo:!1});const _={\"Content-Type\":\"application/json\"};a&&(_.Authorization=\"Bearer \".concat(a));try{var w,C;this.setState(t=>({totalRequests:t.totalRequests+1}));const s=await fetch(e,{method:\"POST\",headers:_,body:JSON.stringify(y),signal:this.abortController.signal});if(!s.ok){const t=await s.text();throw console.error(\"API Error Response:\",t),this.setState(t=>({failedRequests:t.failedRequests+1})),new Error(\"HTTP error! status: \".concat(s.status))}this.setState(t=>({requestsThisMinute:t.requestsThisMinute+1,successfulRequests:t.successfulRequests+1}));const o=await s.json(),r=(null===(w=o.usage)||void 0===w?void 0:w.prompt_tokens)||0,n=(null===(C=o.usage)||void 0===C?void 0:C.completion_tokens)||0,a=this.props.args.token_cost||.05,i=this.props.args.output_token_cost||.1,l=r||Math.ceil(f.length/4),c=l/1e6*a,u=(n||0)/1e6*i;this.setState(t=>({inputCost:t.inputCost+c,outputCost:t.outputCost+u,totalCost:t.totalCost+c+u}));let p=\"\",h=null;if(b&&o.choices&&o.choices[0]&&o.choices[0].message)h=o.choices[0].message,p=h.content||\"\";else{if(!(o.choices&&o.choices[0]&&o.choices[0].text))return console.error(\"Unexpected response format:\",o),\"\";p=o.choices[0].text}if(console.log(\"Full AI Response:\",p),b&&h&&h.tool_calls&&h.tool_calls.length>0){console.log(\"Tool calls detected:\",h.tool_calls);const s=await this.executeToolCalls(h.tool_calls);console.log(\"Tool execution results:\",s);return await this.makeFollowUpCall(e,t,s)}let d=\"\";const m=p.indexOf(\"<answer>\");if(-1!==m){d=p.substring(m+8);const t=d.indexOf(\"</answer>\");-1!==t&&(d=d.substring(0,t))}else d=p;return console.log(\"Extracted Answer:\",d),d}catch(T){return T instanceof Error&&\"AbortError\"===T.name||console.error(\"Error decoding response\",T),\"\"}}}componentDidUpdate(){this.userTextarea&&this.suggestionTextarea&&(this.suggestionTextarea.scrollTop=this.userTextarea.scrollTop)}componentWillUnmount(){null!==this.state.debounceTimer&&window.clearTimeout(this.state.debounceTimer)}}var d=Object(c.c)(h);a.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d,null)),document.getElementById(\"root\"))},7:function(t,e,s){t.exports=s(14)}},[[7,1,2]]]);","extractedComments":[]}