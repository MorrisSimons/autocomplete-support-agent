{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/home/morrissimons/Desktop/lysa-support-agent/custom_text_input/component/frontend/node_modules/@babel/runtime/helpers/objectSpread2\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BulkOperationsProvider = void 0;\nconst db_data_1 = require(\"../../pinecone-generated-ts-fetch/db_data\");\nconst utils_1 = require(\"../../utils\");\nconst indexHostSingleton_1 = require(\"../indexHostSingleton\");\nconst middleware_1 = require(\"../../utils/middleware\");\nclass BulkOperationsProvider {\n  constructor(config, indexName, indexHostUrl, additionalHeaders) {\n    this.config = config;\n    this.indexName = indexName;\n    this.indexHostUrl = (0, utils_1.normalizeUrl)(indexHostUrl);\n    this.additionalHeaders = additionalHeaders;\n  }\n  async provide() {\n    if (this.bulkOperations) {\n      return this.bulkOperations;\n    }\n    // If an indexHostUrl has been manually passed we use that,\n    // otherwise we rely on resolving the host from the IndexHostSingleton\n    if (this.indexHostUrl) {\n      this.bulkOperations = this.buildBulkOperationsConfig();\n    } else {\n      this.indexHostUrl = await indexHostSingleton_1.IndexHostSingleton.getHostUrl(this.config, this.indexName);\n      this.bulkOperations = this.buildBulkOperationsConfig();\n    }\n    return this.bulkOperations;\n  }\n  buildBulkOperationsConfig() {\n    const headers = this.additionalHeaders || null;\n    const indexConfigurationParameters = {\n      basePath: this.indexHostUrl,\n      apiKey: this.config.apiKey,\n      queryParamsStringify: utils_1.queryParamsStringify,\n      headers: _objectSpread({\n        'User-Agent': (0, utils_1.buildUserAgent)(this.config),\n        'X-Pinecone-Api-Version': db_data_1.X_PINECONE_API_VERSION\n      }, headers),\n      fetchApi: (0, utils_1.getFetch)(this.config),\n      middleware: middleware_1.middleware\n    };\n    const indexConfiguration = new db_data_1.Configuration(indexConfigurationParameters);\n    return new db_data_1.BulkOperationsApi(indexConfiguration);\n  }\n}\nexports.BulkOperationsProvider = BulkOperationsProvider;","map":{"version":3,"mappings":";;;;;;;AAEA;AAMA;AAMA;AACA;AAEA,MAAaA,sBAAsB;EAOjCC,YACEC,MAA6B,EAC7BC,SAAiB,EACjBC,YAAqB,EACrBC,iBAA+B;IAE/B,IAAI,CAACH,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,YAAY,GAAG,wBAAY,EAACA,YAAY,CAAC;IAC9C,IAAI,CAACC,iBAAiB,GAAGA,iBAAiB;EAC5C;EAEA,MAAMC,OAAO;IACX,IAAI,IAAI,CAACC,cAAc,EAAE;MACvB,OAAO,IAAI,CAACA,cAAc;;IAG5B;IACA;IACA,IAAI,IAAI,CAACH,YAAY,EAAE;MACrB,IAAI,CAACG,cAAc,GAAG,IAAI,CAACC,yBAAyB,EAAE;KACvD,MAAM;MACL,IAAI,CAACJ,YAAY,GAAG,MAAMK,uCAAkB,CAACC,UAAU,CACrD,IAAI,CAACR,MAAM,EACX,IAAI,CAACC,SAAS,CACf;MAED,IAAI,CAACI,cAAc,GAAG,IAAI,CAACC,yBAAyB,EAAE;;IAGxD,OAAO,IAAI,CAACD,cAAc;EAC5B;EAEAC,yBAAyB;IACvB,MAAMG,OAAO,GAAG,IAAI,CAACN,iBAAiB,IAAI,IAAI;IAE9C,MAAMO,4BAA4B,GAA4B;MAC5DC,QAAQ,EAAE,IAAI,CAACT,YAAY;MAC3BU,MAAM,EAAE,IAAI,CAACZ,MAAM,CAACY,MAAM;MAC1BC,oBAAoB,EAApBC,4BAAoB;MACpBL,OAAO;QACL,YAAY,EAAE,0BAAc,EAAC,IAAI,CAACT,MAAM,CAAC;QACzC,wBAAwB,EAAEe;MAAsB,GAC7CN,OAAO,CACX;MACDO,QAAQ,EAAE,oBAAQ,EAAC,IAAI,CAAChB,MAAM,CAAC;MAC/BiB,UAAU,EAAVC;KACD;IAED,MAAMC,kBAAkB,GAAG,IAAIJ,uBAAa,CAACL,4BAA4B,CAAC;IAC1E,OAAO,IAAIK,2BAAiB,CAACI,kBAAkB,CAAC;EAClD;;AA1DFC","names":["BulkOperationsProvider","constructor","config","indexName","indexHostUrl","additionalHeaders","provide","bulkOperations","buildBulkOperationsConfig","indexHostSingleton_1","getHostUrl","headers","indexConfigurationParameters","basePath","apiKey","queryParamsStringify","utils_1","db_data_1","fetchApi","middleware","middleware_1","indexConfiguration","exports"],"sourceRoot":"","sources":["../../../src/data/bulk/bulkOperationsProvider.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}