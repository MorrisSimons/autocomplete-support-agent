{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/home/morrissimons/Desktop/lysa-support-agent/custom_text_input/component/frontend/node_modules/@babel/runtime/helpers/objectSpread2\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.VectorOperationsProvider = void 0;\nconst db_data_1 = require(\"../../pinecone-generated-ts-fetch/db_data\");\nconst utils_1 = require(\"../../utils\");\nconst indexHostSingleton_1 = require(\"../indexHostSingleton\");\nconst middleware_1 = require(\"../../utils/middleware\");\nclass VectorOperationsProvider {\n  constructor(config, indexName, indexHostUrl, additionalHeaders) {\n    this.config = config;\n    this.indexName = indexName;\n    this.indexHostUrl = (0, utils_1.normalizeUrl)(indexHostUrl);\n    this.additionalHeaders = additionalHeaders;\n  }\n  async provide() {\n    if (this.vectorOperations) {\n      return this.vectorOperations;\n    }\n    // If an indexHostUrl has been manually passed we use that,\n    // otherwise we rely on resolving the host from the IndexHostSingleton\n    if (this.indexHostUrl) {\n      this.vectorOperations = this.buildDataOperationsConfig();\n    } else {\n      this.indexHostUrl = await indexHostSingleton_1.IndexHostSingleton.getHostUrl(this.config, this.indexName);\n      this.vectorOperations = this.buildDataOperationsConfig();\n    }\n    return this.vectorOperations;\n  }\n  async provideHostUrl() {\n    return await indexHostSingleton_1.IndexHostSingleton.getHostUrl(this.config, this.indexName);\n  }\n  buildDataOperationsConfig() {\n    const headers = this.additionalHeaders || null;\n    const indexConfigurationParameters = {\n      basePath: this.indexHostUrl,\n      apiKey: this.config.apiKey,\n      queryParamsStringify: utils_1.queryParamsStringify,\n      headers: _objectSpread({\n        'User-Agent': (0, utils_1.buildUserAgent)(this.config),\n        'X-Pinecone-Api-Version': db_data_1.X_PINECONE_API_VERSION\n      }, headers),\n      fetchApi: (0, utils_1.getFetch)(this.config),\n      middleware: middleware_1.middleware\n    };\n    const indexConfiguration = new db_data_1.Configuration(indexConfigurationParameters);\n    return new db_data_1.VectorOperationsApi(indexConfiguration);\n  }\n}\nexports.VectorOperationsProvider = VectorOperationsProvider;","map":{"version":3,"mappings":";;;;;;;AAEA;AAMA;AAMA;AACA;AAEA,MAAaA,wBAAwB;EAOnCC,YACEC,MAA6B,EAC7BC,SAAiB,EACjBC,YAAqB,EACrBC,iBAA+B;IAE/B,IAAI,CAACH,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,YAAY,GAAG,wBAAY,EAACA,YAAY,CAAC;IAC9C,IAAI,CAACC,iBAAiB,GAAGA,iBAAiB;EAC5C;EAEA,MAAMC,OAAO;IACX,IAAI,IAAI,CAACC,gBAAgB,EAAE;MACzB,OAAO,IAAI,CAACA,gBAAgB;;IAG9B;IACA;IACA,IAAI,IAAI,CAACH,YAAY,EAAE;MACrB,IAAI,CAACG,gBAAgB,GAAG,IAAI,CAACC,yBAAyB,EAAE;KACzD,MAAM;MACL,IAAI,CAACJ,YAAY,GAAG,MAAMK,uCAAkB,CAACC,UAAU,CACrD,IAAI,CAACR,MAAM,EACX,IAAI,CAACC,SAAS,CACf;MAED,IAAI,CAACI,gBAAgB,GAAG,IAAI,CAACC,yBAAyB,EAAE;;IAG1D,OAAO,IAAI,CAACD,gBAAgB;EAC9B;EAEA,MAAMI,cAAc;IAClB,OAAO,MAAMF,uCAAkB,CAACC,UAAU,CAAC,IAAI,CAACR,MAAM,EAAE,IAAI,CAACC,SAAS,CAAC;EACzE;EAEAK,yBAAyB;IACvB,MAAMI,OAAO,GAAG,IAAI,CAACP,iBAAiB,IAAI,IAAI;IAE9C,MAAMQ,4BAA4B,GAA4B;MAC5DC,QAAQ,EAAE,IAAI,CAACV,YAAY;MAC3BW,MAAM,EAAE,IAAI,CAACb,MAAM,CAACa,MAAM;MAC1BC,oBAAoB,EAApBC,4BAAoB;MACpBL,OAAO;QACL,YAAY,EAAE,0BAAc,EAAC,IAAI,CAACV,MAAM,CAAC;QACzC,wBAAwB,EAAEgB;MAAsB,GAC7CN,OAAO,CACX;MACDO,QAAQ,EAAE,oBAAQ,EAAC,IAAI,CAACjB,MAAM,CAAC;MAC/BkB,UAAU,EAAVC;KACD;IAED,MAAMC,kBAAkB,GAAG,IAAIJ,uBAAa,CAACL,4BAA4B,CAAC;IAC1E,OAAO,IAAIK,6BAAmB,CAACI,kBAAkB,CAAC;EACpD;;AA9DFC","names":["VectorOperationsProvider","constructor","config","indexName","indexHostUrl","additionalHeaders","provide","vectorOperations","buildDataOperationsConfig","indexHostSingleton_1","getHostUrl","provideHostUrl","headers","indexConfigurationParameters","basePath","apiKey","queryParamsStringify","utils_1","db_data_1","fetchApi","middleware","middleware_1","indexConfiguration","exports"],"sourceRoot":"","sources":["../../../src/data/vectors/vectorOperationsProvider.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}